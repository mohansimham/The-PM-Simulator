<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 1: PM Fundamentals - Airbnb Platform Evolution</title>
    <meta name="description" content="Test your product management fundamentals with this Airbnb case study simulation.">
    
    <!-- Open Graph for LinkedIn sharing -->
    <meta property="og:title" content="Week 1: PM Fundamentals - Airbnb Simulation">
    <meta property="og:description" content="Can you navigate Airbnb's early growth decisions? Test your PM skills.">
    <meta property="og:type" content="website">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Professional formal color overrides */
        .bg-indigo-600 { background-color: #1e40af !important; } /* Navy blue */
        .bg-indigo-100 { background-color: #dbeafe !important; } /* Light blue */
        .text-indigo-600 { color: #1e40af !important; }
        .border-indigo-500 { border-color: #2563eb !important; }
        .from-indigo-600 { --tw-gradient-from: #1e40af !important; }
        .to-blue-600 { --tw-gradient-to: #3b82f6 !important; } /* Professional blue */
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script>
        const { useState, useEffect } = React;
        const { createElement: h } = React;

        // Google Apps Script Web App URL for email collection
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz6E8UJUn5xhilm2pLWjdvaip_6MnSCf-XRVPv5u4hOttjr0SNCu9I10q2ESLKGQ04_mQ/exec';

        // Icon components as simple SVGs
        const Share2Icon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            h('path', { d: 'M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8' }),
            h('polyline', { points: '16 6 12 2 8 6' }),
            h('line', { x1: 12, y1: 2, x2: 12, y2: 15 })
        );

        const MailIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            h('path', { d: 'M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z' }),
            h('polyline', { points: '22,6 12,13 2,6' })
        );

        const TrophyIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            h('path', { d: 'M6 9H4.5a2.5 2.5 0 0 1 0-5H6' }),
            h('path', { d: 'M18 9h1.5a2.5 2.5 0 0 0 0-5H18' }),
            h('path', { d: 'M4 22h16' }),
            h('path', { d: 'M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22' }),
            h('path', { d: 'M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22' }),
            h('path', { d: 'M18 2H6v7a6 6 0 0 0 12 0V2Z' })
        );

        const TrendingUpIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            h('polyline', { points: '23 6 13.5 15.5 8.5 10.5 1 18' }),
            h('polyline', { points: '17 6 23 6 23 12' })
        );

        const UsersIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
            h('path', { d: 'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }),
            h('circle', { cx: 9, cy: 7, r: 4 }),
            h('path', { d: 'M23 21v-2a4 4 0 0 0-3-3.87' }),
            h('path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' })
        );

        function PMSimulation() {
            const [email, setEmail] = useState('');
            const [hasStarted, setHasStarted] = useState(false);
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [answers, setAnswers] = useState([]);
            const [selectedAnswerIndex, setSelectedAnswerIndex] = useState(null);
            const [showResults, setShowResults] = useState(false);
            const [hasAttempted, setHasAttempted] = useState(false);

            // SNIPPET 1: Session Persistence - Restore email on page load
            useEffect(() => {
                // Check for saved email on page load
                const storedEmail = localStorage.getItem('pmSimEmail');
                const storedStartTime = localStorage.getItem('pmSimStartTime');
                
                if (storedEmail) {
                    setEmail(storedEmail);
                    
                    // If they started within last 24 hours, let them continue
                    const hoursSinceStart = (Date.now() - new Date(storedStartTime)) / (1000 * 60 * 60);
                    if (hoursSinceStart < 24) {
                        setHasStarted(true);
                    }
                }
            }, []);

            useEffect(() => {
                // Creator backdoor: Check if URL has ?reset=true parameter
                const urlParams = new URLSearchParams(window.location.search);
                const resetMode = urlParams.get('reset') === 'true';
                
                if (resetMode) {
                    // Creator mode: Clear the attempt flag and allow retaking
                    localStorage.removeItem('pmSimAttempted');
                    localStorage.removeItem('pmSimEmail');
                    localStorage.removeItem('pmSimStartTime');
                    setHasAttempted(false);
                }
            }, []);

            useEffect(() => {
                // Check if user has attempted before
                const attempted = localStorage.getItem('pmSimAttempted') === 'true';
                setHasAttempted(attempted);
            }, []);

            const simulation = {
                title: "Week 1: PM Fundamentals - Airbnb Platform Evolution",
                description: "Test your product thinking on Airbnb's early growth decisions",
                duration: "5 questions",
                difficulty: "Fundamental",
                learningObjective: "Apply PM fundamentals to prioritize trust, growth, and platform experience.",
                questions: [
                    {
                        id: 1,
                        scenario: "It's 2009, and Airbnb is still a tiny startup. Hosts are joining, but many potential guests are hesitant to book because they're uncertain about what they'll find when they arrive. Trust is low.",
                        question: "What's your first PM priority to help guests make more confident booking decisions?",
                        options: [
                            {
                                text: "Launch a campaign highlighting unique listings and celebrity endorsements.",
                                points: 3,
                                feedback: "Celebrity campaigns can boost awareness, but they don't directly address the core issue: guests need transparency about what they're booking. For early-stage products, visibility into what customers are buying matters more than who's promoting it."
                            },
                            {
                                text: "Build a professional photo program to showcase homes accurately.",
                                points: 10,
                                feedback: "Excellent choice! High-quality, professional photos directly reduce uncertainty and build trustâ€”two critical barriers to conversion in a two-sided marketplace. Airbnb famously invested in this early, and it became one of their biggest growth levers."
                            },
                            {
                                text: "Offer a money-back guarantee if the listing doesn't match the description.",
                                points: 6,
                                feedback: "A guarantee is a good trust signal, but it's reactiveâ€”it only matters after a bad experience. Showing accurate photos upfront prevents bad experiences from happening in the first place, which is more powerful for growth."
                            },
                            {
                                text: "Focus on attracting more hosts to increase selection before improving photos.",
                                points: 2,
                                feedback: "More inventory is useful, but if guests don't trust the listings they see, they won't book anyway. In two-sided markets, quality and trust often matter more than pure quantity early on. Airbnb learned this when they pivoted to professional photos."
                            }
                        ]
                    },
                    {
                        id: 2,
                        scenario: "Bookings are growing steadily, but you're starting to see negative reviews where guests feel misledâ€”photos looked great, but the space was smaller, dirtier, or missing amenities shown in the listing.",
                        question: "What's the root cause of this trust problem, and what should you prioritize to fix it?",
                        options: [
                            {
                                text: "Guests have unrealistic expectations; we should educate them about home-sharing norms.",
                                points: 2,
                                feedback: "Blaming the user is rarely the right PM mindset. If many guests feel misled, the product isn't setting accurate expectations. Education can help, but it won't fix the core issue: listing accuracy."
                            },
                            {
                                text: "Hosts are misrepresenting their spaces; we should enforce stricter photo and description requirements.",
                                points: 10,
                                feedback: "Exactly. When trust breaks down at scale, it's often a structural problem in your product's information architecture. Enforcing standards for how listings are presented is the most scalable way to ensure accurate expectationsâ€”and prevent bad experiences."
                            },
                            {
                                text: "Create a rating system where hosts with too many bad reviews get flagged or delisted.",
                                points: 6,
                                feedback: "This is a good reactive measure, but it only addresses problems after they happen. Better to prevent misleading listings upfront by improving listing standardsâ€”then use reviews as a secondary quality signal."
                            },
                            {
                                text: "Launch an insurance program to compensate guests who have a bad experience.",
                                points: 4,
                                feedback: "Compensation can soften the blow, but it doesn't solve the root cause: inaccurate listings. PMs should focus on prevention before protection. Fixing the product is always better than paying for its failures."
                            }
                        ]
                    },
                    {
                        id: 3,
                        scenario: "You've launched a two-way review system where both guests and hosts rate each other. Data shows that hosts are reluctant to leave honest negative feedback because they worry guests will retaliate with a bad review in return.",
                        question: "What product change would make the review system more honest and useful?",
                        options: [
                            {
                                text: "Remove the two-way review system and only let guests review hosts.",
                                points: 3,
                                feedback: "This solves one problem but creates another: hosts lose protection against bad guests. Two-sided accountability is actually valuable in a marketplace; the issue is the timing and visibility of feedback."
                            },
                            {
                                text: "Make reviews anonymous so no one knows who wrote what.",
                                points: 2,
                                feedback: "Anonymity can encourage honesty, but it also removes accountability. On platforms like Airbnb, trust comes from knowing who's saying what. The better fix is changing when reviews are revealed, not who can see them."
                            },
                            {
                                text: "Reveal reviews only after both parties have submitted theirs (or the review window closes).",
                                points: 10,
                                feedback: "Perfect. This is exactly what Airbnb did. By blinding reviews until both are submitted, you remove the fear of retaliation while keeping the system transparent and accountable. It's a simple mechanism design change with huge impact."
                            },
                            {
                                text: "Offer incentives like discounts to hosts who leave honest reviews.",
                                points: 4,
                                feedback: "Incentives might increase review volume, but they don't solve the retaliation problem. Hosts will still fear negative consequences. The issue is structural, not motivationalâ€”so the fix should be in the review mechanism itself."
                            }
                        ]
                    },
                    {
                        id: 4,
                        scenario: "Guests love booking entire homes, but some neighborhoods are starting to push backâ€”they feel like Airbnb is turning residential areas into hotels. Local officials are considering regulations that could limit or ban short-term rentals.",
                        question: "From a PM perspective focused on sustainable growth, what should Airbnb prioritize?",
                        options: [
                            {
                                text: "Fight regulations aggressively and lobby to keep the platform open in all neighborhoods.",
                                points: 3,
                                feedback: "Lobbying can work short-term, but ignoring community concerns isn't sustainable. PMs should think long-term: if neighbors turn against your product, it creates existential risk. Better to engage proactively than react defensively."
                            },
                            {
                                text: "Partner with cities to create clear hosting rules (e.g., limits on rental days, registration requirements).",
                                points: 10,
                                feedback: "Exactly. Sustainable growth means working with regulators, not against them. By co-creating rules, Airbnb can legitimize its platform, reduce friction, and build trust with both communities and governmentsâ€”critical for long-term viability."
                            },
                            {
                                text: "Shift focus entirely to promoting 'private room' rentals since they're less disruptive to neighborhoods.",
                                points: 5,
                                feedback: "Private rooms are less controversial, but they're not what drives most of Airbnb's growth or revenue. Instead of changing your product entirely, work with stakeholders to find a compromise that protects both growth and community interests."
                            },
                            {
                                text: "Ignore the regulationsâ€”most hosts will keep listing regardless of local laws.",
                                points: 1,
                                feedback: "This is a dangerous strategy. If Airbnb is seen as enabling illegal activity, it risks lawsuits, bans, and loss of trust. PMs should never assume the product can exist outside the law. Regulatory compliance is a core growth constraint."
                            }
                        ]
                    },
                    {
                        id: 5,
                        scenario: "Airbnb has grown globally, and you're seeing data that shows: (1) guests value unique, local experiences, not just cheap beds; (2) hosts who offer 'Experiences' (e.g., cooking classes, city tours) earn more and get better reviews than those who only rent space.",
                        question: "Should Airbnb expand beyond home rentals into experiences, and why?",
                        options: [
                            {
                                text: "Noâ€”Airbnb is a home-sharing platform, and adding experiences would dilute the brand.",
                                points: 3,
                                feedback: "Sticking to your core is important, but great PMs know when to evolve. If the data shows users want something adjacent to your product, expanding thoughtfully can strengthen your brand, not dilute it. Airbnb's mission was always about 'belonging,' not just beds."
                            },
                            {
                                text: "Yesâ€”if guests want local experiences, Airbnb should own that market too.",
                                points: 6,
                                feedback: "Good instinct, but this reasoning is too vague. Just because users want something doesn't mean you should build it. The better rationale is strategic fit: Experiences deepen engagement, increase revenue per user, and align with Airbnb's mission of local belonging."
                            },
                            {
                                text: "Yesâ€”experiences increase customer lifetime value and align with Airbnb's mission of authentic travel.",
                                points: 10,
                                feedback: "Exactly. This is the PM way to think about product expansion: Does it drive key metrics (LTV)? Does it fit our mission? Does it strengthen the platform? Airbnb Experiences did all three, turning hosts into multi-product entrepreneurs."
                            },
                            {
                                text: "Noâ€”there are already companies offering tours and activities. Airbnb should partner with them instead.",
                                points: 5,
                                feedback: "Partnerships can work, but they don't give you control over quality, margins, or the customer experience. When something is core to your value prop, building it in-house is often better than outsourcing it to third parties."
                            }
                        ]
                    }
                ]
            };

            // SNIPPET 2: Send email to Google Sheets via Apps Script
            const submitEmail = async () => {
                if (!email || !/\S+@\S+\.\S+/.test(email)) {
                    alert('Please enter a valid email address.');
                    return false;
                }
                
                try {
                    // Save email immediately in localStorage
                    localStorage.setItem('pmSimEmail', email);
                    localStorage.setItem('pmSimStartTime', new Date().toISOString());
                    
                    // Try to submit to Google Sheets
                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors', // Google Apps Script requires no-cors
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            email: email,
                            timestamp: new Date().toISOString(),
                            event: 'simulation_start'
                        })
                    });
                    
                    console.log('ðŸ“§ Email submitted successfully');
                    return true;
                } catch (error) {
                    console.error('ðŸ“§ Error submitting email:', error);
                    // Still let them proceed since email is saved locally
                    return true;
                }
            };

            // SNIPPET 3: Track results with retry logic
            const submitResults = async (finalAnswers) => {
                const totalScore = finalAnswers.reduce((sum, answer) => sum + answer.points, 0);
                const maxScore = simulation.questions.reduce((sum, q) => {
                    const maxPoints = Math.max(...q.options.map(o => o.points));
                    return sum + maxPoints;
                }, 0);
                
                const resultData = {
                    email: email,
                    timestamp: new Date().toISOString(),
                    event: 'simulation_complete',
                    score: totalScore,
                    maxScore: maxScore,
                    percentage: Math.round((totalScore / maxScore) * 100),
                    answers: finalAnswers
                };
                
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(resultData)
                    });
                    
                    console.log('ðŸ“Š Results submitted successfully');
                } catch (error) {
                    console.error('ðŸ“Š Error submitting results:', error);
                    
                    // SNIPPET 4: Save failed submission for retry
                    const failedEvents = JSON.parse(localStorage.getItem('pmSimFailedEvents') || '[]');
                    failedEvents.push(resultData);
                    localStorage.setItem('pmSimFailedEvents', JSON.stringify(failedEvents));
                    console.log('ðŸ’¾ Saved result for later retry');
                }
            };

            const handleStart = async () => {
                const success = await submitEmail();
                if (success) {
                    setHasStarted(true);
                }
            };

            const handleAnswer = (answerIndex) => {
                setSelectedAnswerIndex(answerIndex);
            };

            const handleNextChallenge = () => {
                if (selectedAnswerIndex === null) return;

                const userAnswer = simulation.questions[currentQuestion].options[selectedAnswerIndex];
                const newAnswers = [...answers, {
                    questionId: simulation.questions[currentQuestion].id,
                    answerIndex: selectedAnswerIndex,
                    points: userAnswer.points,
                    feedback: userAnswer.feedback
                }];
                setAnswers(newAnswers);
                setSelectedAnswerIndex(null);

                if (currentQuestion === simulation.questions.length - 1) {
                    setShowResults(true);
                    localStorage.setItem('pmSimAttempted', 'true');
                    submitResults(newAnswers);
                } else {
                    setCurrentQuestion(currentQuestion + 1);
                }
            };

            // FIXED: LinkedIn Share Function with clean text-only content
            const handleLinkedInShare = () => {
                // Define the clean post text WITHOUT any JavaScript
                const linkedInPostText = `This simulation tests real-world PM thinking through Airbnb's early-stage growth decisions.

Think you can beat my score?
Take the free simulation: https://mohansimham.github.io/The-PM-Simulator/

#ProductManagement #PMSkills #CareerGrowth #Leadership #ProductStrategy #TechCareers

ðŸ‘‰ Follow for 20 PM simulations: linkedin.com/in/mohansimham`;

                // Copy to clipboard
                navigator.clipboard.writeText(linkedInPostText).then(() => {
                    console.log('âœ… Text copied to clipboard');
                }).catch(err => {
                    console.error('âŒ Failed to copy text:', err);
                });

                // Open LinkedIn in new tab
                window.open('https://www.linkedin.com/feed/', '_blank');
            };

            // Show share modal function - creates modal dynamically
            const showLinkedInModal = () => {
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999;';
                
                const modalContent = document.createElement('div');
                modalContent.style.cssText = 'background: white; padding: 32px; border-radius: 16px; max-width: 500px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);';
                
                modalContent.innerHTML = `
                    <h3 style="font-size: 20px; font-weight: bold; margin-bottom: 16px; color: #1e293b;">Share on LinkedIn</h3>
                    <p style="margin-bottom: 8px; color: #475569; font-size: 14px;">Click the button below (copies text + opens LinkedIn)</p>
                    <p style="margin-bottom: 8px; color: #475569; font-size: 14px;">Click "Start a post" on LinkedIn</p>
                    <p style="margin-bottom: 20px; color: #475569; font-size: 14px;">Paste (Ctrl+V or Cmd+V) and click Post! ðŸš€</p>
                    <button id="copyAndOpenBtn" style="width: 100%; background: #0A66C2; color: white; padding: 16px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; margin-bottom: 12px; transition: all 0.3s;">
                        ðŸ“‹ Copy & Open LinkedIn
                    </button>
                    <button id="cancelBtn" style="width: 100%; background: #e2e8f0; color: #475569; padding: 12px; border: none; border-radius: 8px; font-size: 14px; cursor: pointer;">
                        Cancel
                    </button>
                `;
                
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
                
                // Add event listeners
                document.getElementById('copyAndOpenBtn').addEventListener('click', () => {
                    handleLinkedInShare();
                    document.body.removeChild(modal);
                });
                
                document.getElementById('cancelBtn').addEventListener('click', () => {
                    document.body.removeChild(modal);
                });
                
                // Close on background click
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                    }
                });
            };

            if (hasAttempted && !showResults) {
                return h('div', { className: 'min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-6' },
                    h('div', { className: 'max-w-2xl w-full' },
                        h('div', { className: 'bg-white rounded-2xl shadow-xl p-8 text-center' },
                            h('div', { className: 'w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6' },
                                h('span', { className: 'text-4xl' }, 'âœ“')
                            ),
                            h('h2', { className: 'text-3xl font-bold text-gray-900 mb-4' }, 'You\'ve Already Completed This Module'),
                            h('p', { className: 'text-gray-600 mb-6' }, 
                                'To maintain the learning challenge, each simulation can only be attempted once. Check your email for your results and feedback.'
                            ),
                            h('div', { className: 'bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r mb-6' },
                                h('p', { className: 'text-sm text-blue-900' }, 
                                    'ðŸ’¡ Tip: Each week builds on the last. Review your feedback and get ready for Simulation 2/20 in the PM challenge!'
                                )
                            ),
                            h('div', { className: 'flex flex-col sm:flex-row gap-3 justify-center' },
                                h('a', {
                                    href: 'https://linkedin.com/in/mohansimham',
                                    target: '_blank',
                                    className: 'inline-flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all'
                                }, 
                                    h(Share2Icon),
                                    'Follow for Simulation 2/20'
                                ),
                                h('a', {
                                    href: 'mailto:mohansimham@gmail.com',
                                    className: 'inline-flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 transition-all'
                                },
                                    h(MailIcon),
                                    'Questions? Email Me'
                                )
                            )
                        )
                    )
                );
            }

            if (!hasStarted) {
                return h('div', { className: 'min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-6' },
                    h('div', { className: 'max-w-4xl w-full' },
                        h('div', { className: 'bg-white rounded-2xl shadow-2xl overflow-hidden' },
                            h('div', { className: 'bg-gradient-to-r from-indigo-600 to-blue-600 text-white p-8 sm:p-12' },
                                h('div', { className: 'flex items-center gap-3 mb-4' },
                                    h('div', { className: 'bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full text-sm font-medium' }, 'Simulation 1/20')
                                ),
                                h('h1', { className: 'text-3xl sm:text-4xl font-bold mb-3' }, simulation.title),
                                h('p', { className: 'text-blue-100 text-lg mb-6' }, simulation.description),
                                h('div', { className: 'flex flex-wrap gap-4 text-sm' },
                                    h('div', { className: 'flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg' },
                                        h('span', null, 'â±ï¸'),
                                        h('span', null, simulation.duration)
                                    ),
                                    h('div', { className: 'flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg' },
                                        h('span', null, 'ðŸ“Š'),
                                        h('span', null, simulation.difficulty)
                                    )
                                )
                            ),
                            h('div', { className: 'p-8 sm:p-12' },
                                h('div', { className: 'mb-8' },
                                    h('h3', { className: 'text-lg font-bold text-gray-900 mb-3' }, 'ðŸŽ¯ Learning Objective'),
                                    h('p', { className: 'text-gray-700' }, simulation.learningObjective)
                                ),
                                h('div', { className: 'bg-blue-50 border-l-4 border-blue-600 p-6 rounded-r mb-8' },
                                    h('h4', { className: 'font-bold text-blue-900 mb-2' }, 'How It Works'),
                                    h('ul', { className: 'space-y-2 text-sm text-blue-800' },
                                        h('li', { className: 'flex items-start gap-2' },
                                            h('span', { className: 'text-blue-600 font-bold' }, '1.'),
                                            h('span', null, 'Answer 5 real-world PM scenarios based on Airbnb\'s journey')
                                        ),
                                        h('li', { className: 'flex items-start gap-2' },
                                            h('span', { className: 'text-blue-600 font-bold' }, '2.'),
                                            h('span', null, 'Each choice is scored based on PM best practices')
                                        ),
                                        h('li', { className: 'flex items-start gap-2' },
                                            h('span', { className: 'text-blue-600 font-bold' }, '3.'),
                                            h('span', null, 'Get personalized feedback from Mohan Simham (ex-PM at Microsoft & Goldman Sachs)')
                                        ),
                                        h('li', { className: 'flex items-start gap-2' },
                                            h('span', { className: 'text-blue-600 font-bold' }, 'âš ï¸'),
                                            h('span', { className: 'font-semibold' }, 'You can only attempt this simulation onceâ€”make your choices count!')
                                        )
                                    )
                                ),
                                h('div', { className: 'space-y-4' },
                                    h('div', null,
                                        h('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'Enter your email to start'),
                                        h('input', {
                                            type: 'email',
                                            value: email,
                                            onChange: (e) => setEmail(e.target.value),
                                            onKeyPress: (e) => {
                                                if (e.key === 'Enter') handleStart();
                                            },
                                            placeholder: 'your.email@example.com',
                                            className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-gray-900'
                                        })
                                    ),
                                    h('button', {
                                        onClick: handleStart,
                                        className: 'w-full bg-gradient-to-r from-indigo-600 to-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:shadow-xl transition-all transform hover:scale-[1.02]'
                                    }, 'Start Simulation â†’')
                                ),
                                h('p', { className: 'text-xs text-gray-500 text-center mt-4' }, 
                                    'ðŸ”’ Your email is only used to send you results. We respect your privacy.'
                                )
                            )
                        ),
                        h('div', { className: 'text-center mt-8' },
                            h('p', { className: 'text-sm text-gray-600 mb-2' }, 'Created by Mohan Simham'),
                            h('a', { 
                                href: 'https://linkedin.com/in/mohansimham',
                                target: '_blank',
                                className: 'text-blue-600 hover:text-blue-700 text-sm font-medium'
                            }, 'Connect on LinkedIn â†’')
                        )
                    )
                );
            }

            if (showResults) {
                const totalScore = answers.reduce((sum, answer) => sum + answer.points, 0);
                const maxScore = simulation.questions.reduce((sum, q) => {
                    const maxPoints = Math.max(...q.options.map(o => o.points));
                    return sum + maxPoints;
                }, 0);
                const percentage = Math.round((totalScore / maxScore) * 100);
                
                let performanceLevel;
                let performanceMessage;
                let performanceColor;
                
                if (percentage >= 90) {
                    performanceLevel = "Outstanding PM Thinking";
                    performanceMessage = "You demonstrated expert-level product judgment. You're thinking like a senior PM!";
                    performanceColor = "text-green-600";
                } else if (percentage >= 75) {
                    performanceLevel = "Strong PM Fundamentals";
                    performanceMessage = "You showed solid product thinking with room to refine your prioritization skills.";
                    performanceColor = "text-blue-600";
                } else if (percentage >= 60) {
                    performanceLevel = "Developing PM Skills";
                    performanceMessage = "You're on the right track. Review the feedback to strengthen your PM decision-making.";
                    performanceColor = "text-yellow-600";
                } else {
                    performanceLevel = "Building PM Foundation";
                    performanceMessage = "Great start! Focus on the feedback to build stronger product intuition.";
                    performanceColor = "text-orange-600";
                }

                return h('div', { className: 'min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-6' },
                    h('div', { className: 'max-w-4xl mx-auto' },
                        h('div', { className: 'bg-white rounded-2xl shadow-2xl overflow-hidden mb-6' },
                            h('div', { className: 'bg-gradient-to-r from-indigo-600 to-blue-600 text-white p-8 text-center' },
                                h('div', { className: 'inline-block bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-sm font-medium mb-4' }, 
                                    'Simulation Complete'
                                ),
                                h('h2', { className: 'text-3xl sm:text-4xl font-bold mb-2' }, 'Your PM Scorecard'),
                                h('p', { className: 'text-blue-100 text-lg' }, 
                                    `Week 1: ${simulation.title.split(':')[1]}`
                                )
                            ),
                            h('div', { className: 'p-8' },
                                h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-6 mb-8' },
                                    h('div', { className: 'bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 text-center border border-blue-100' },
                                        h('div', { className: 'text-4xl font-bold text-indigo-600 mb-2' }, totalScore),
                                        h('div', { className: 'text-sm text-gray-600 uppercase tracking-wide' }, 'Total Points')
                                    ),
                                    h('div', { className: 'bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 text-center border border-purple-100' },
                                        h('div', { className: 'text-4xl font-bold text-purple-600 mb-2' }, `${percentage}%`),
                                        h('div', { className: 'text-sm text-gray-600 uppercase tracking-wide' }, 'Score')
                                    ),
                                    h('div', { className: 'bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 text-center border border-green-100' },
                                        h('div', { className: 'text-2xl font-bold text-green-600 mb-2' }, 
                                            percentage >= 80 ? 'ðŸ†' : percentage >= 60 ? 'â­' : 'ðŸ“ˆ'
                                        ),
                                        h('div', { className: 'text-sm text-gray-600 uppercase tracking-wide' }, 'Rank')
                                    )
                                ),
                                h('div', { className: 'bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-6 border-l-4 border-indigo-600' },
                                    h('h3', { className: `text-xl font-bold mb-2 ${performanceColor}` }, performanceLevel),
                                    h('p', { className: 'text-gray-700' }, performanceMessage)
                                ),
                                h('div', { className: 'flex flex-col sm:flex-row gap-3 mb-6' },
                                    h('button', {
                                        onClick: showLinkedInModal,
                                        className: 'flex-1 flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-4 rounded-lg font-bold hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl'
                                    },
                                        h(Share2Icon),
                                        'Share My Score on LinkedIn'
                                    ),
                                    h('a', {
                                        href: 'https://linkedin.com/in/mohansimham',
                                        target: '_blank',
                                        className: 'flex-1 flex items-center justify-center gap-2 bg-gradient-to-r from-indigo-600 to-blue-600 text-white px-6 py-4 rounded-lg font-bold hover:shadow-xl transition-all'
                                    },
                                        h(TrophyIcon),
                                        'Follow for Simulation 2/20'
                                    )
                                )
                            )
                        ),
                        h('div', { className: 'space-y-4' },
                            h('h3', { className: 'text-2xl font-bold text-gray-900 mb-4' }, 'ðŸ“‹ Detailed Feedback'),
                            simulation.questions.map((question, qIndex) => {
                                const userAnswer = question.options[answers[qIndex].answerIndex];
                                const correctAnswer = question.options.reduce((max, option) => 
                                    option.points > max.points ? option : max
                                , question.options[0]);
                                const isCorrect = userAnswer.points === correctAnswer.points;
                                
                                return h('div', { key: qIndex, className: 'bg-white rounded-xl shadow-lg overflow-hidden' },
                                    h('div', { className: 'bg-gray-50 px-6 py-4 border-b border-gray-200' },
                                        h('div', { className: 'flex items-start gap-3' },
                                            h('div', { className: 'w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0' },
                                                h('span', { className: 'text-white font-bold text-sm' }, qIndex + 1)
                                            ),
                                            h('div', { className: 'flex-1' },
                                                h('h4', { className: 'font-bold text-gray-900 mb-1' }, question.question),
                                                h('p', { className: 'text-sm text-gray-600' }, question.scenario)
                                            )
                                        )
                                    ),
                                    h('div', { className: 'p-6 space-y-4' },
                                        h('div', { 
                                            className: isCorrect 
                                                ? 'bg-green-50 border-2 border-green-200 rounded-lg p-4' 
                                                : 'bg-orange-50 border-2 border-orange-200 rounded-lg p-4'
                                        },
                                            h('div', { className: 'flex items-start gap-3' },
                                                h('div', { className: 'text-2xl' }, isCorrect ? 'âœ“' : 'â—‹'),
                                                h('div', { className: 'flex-1' },
                                                    h('div', { 
                                                        className: isCorrect 
                                                            ? 'text-xs font-bold text-green-700 uppercase tracking-wide mb-2'
                                                            : 'text-xs font-bold text-orange-700 uppercase tracking-wide mb-2'
                                                    }, 
                                                        isCorrect ? 'Your Answer (Optimal)' : 'Your Answer'
                                                    ),
                                                    h('p', { className: 'text-sm text-gray-800 font-medium mb-2' }, userAnswer.text),
                                                    h('p', { 
                                                        className: isCorrect 
                                                            ? 'text-xs text-green-700 font-medium'
                                                            : 'text-xs text-orange-700 font-medium'
                                                    }, 
                                                        `${userAnswer.points} points${!isCorrect ? ` (out of ${correctAnswer.points} possible)` : ''}`
                                                    )
                                                )
                                            )
                                        ),
                                        
                                        !isCorrect && h('div', { className: 'bg-green-50 border-2 border-green-200 rounded-lg p-4 mb-4' },
                                            h('div', { className: 'flex items-start gap-3' },
                                                h('div', { className: 'text-2xl' }, 'â˜…'),
                                                h('div', { className: 'flex-1' },
                                                    h('div', { className: 'text-xs font-bold text-green-700 uppercase tracking-wide mb-2' }, 
                                                        'Optimal Answer'
                                                    ),
                                                    h('p', { className: 'text-sm text-gray-800 font-medium mb-2' }, correctAnswer.text),
                                                    h('p', { className: 'text-xs text-green-700 font-medium' }, 
                                                        correctAnswer.points + ' points (maximum)'
                                                    )
                                                )
                                            )
                                        ),
                                        
                                        h('div', { className: 'bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r' },
                                            h('div', { className: 'text-xs font-bold text-blue-900 uppercase tracking-wide mb-2' }, 
                                                'ðŸ’¬ Mohan Simham\'s Comments'
                                            ),
                                            h('p', { className: 'text-sm text-gray-700 leading-relaxed mb-3' }, userAnswer.feedback),
                                            !isCorrect && h('div', { className: 'mt-3 pt-3 border-t border-blue-200' },
                                                h('p', { className: 'text-xs font-semibold text-blue-800 mb-2' }, 'Why the optimal answer is better:'),
                                                h('p', { className: 'text-sm text-gray-700 leading-relaxed' }, correctAnswer.feedback)
                                            )
                                        )
                                    )
                                );
                            })
                        ),
                        h('div', { className: 'text-center mt-8' },
                            h('p', { className: 'text-gray-600 mb-2' }, 'Ready for Simulation 2/20? Continue the PM challenge to master product discovery & validation!'),
                            h('p', { className: 'text-sm text-gray-500 mb-1' }, 'Â© 2025 Mohan Simham. All Rights Reserved.'),
                            h('p', { className: 'text-xs text-gray-400' }, 
                                'Curated by Mohan Simham â€¢ ',
                                h('a', { 
                                    href: 'https://linkedin.com/in/mohansimham', 
                                    target: '_blank',
                                    className: 'text-blue-400 hover:text-blue-500 underline'
                                }, 'LinkedIn: /mohansimham')
                            )
                        )
                    )
                );
            }

            const currentQ = simulation.questions[currentQuestion];

            return h('div', { className: 'min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 p-6' },
                h('div', { className: 'max-w-3xl mx-auto' },
                    h('div', { className: 'mb-8' },
                        h('div', { className: 'flex justify-between text-sm text-gray-600 mb-2' },
                            h('span', null, `Question ${currentQuestion + 1} of ${simulation.questions.length}`),
                            h('span', null, `${Math.round(((currentQuestion) / simulation.questions.length) * 100)}% Complete`)
                        ),
                        h('div', { className: 'w-full bg-gray-200 rounded-full h-2' },
                            h('div', {
                                className: 'bg-gradient-to-r from-indigo-600 to-blue-600 h-2 rounded-full transition-all duration-500',
                                style: { width: `${((currentQuestion) / simulation.questions.length) * 100}%` }
                            })
                        )
                    ),
                    h('div', { className: 'bg-white rounded-2xl shadow-xl overflow-hidden' },
                        h('div', { className: 'bg-gradient-to-r from-gray-50 to-gray-100 p-6 border-b border-gray-200' },
                            h('div', { className: 'flex items-start gap-3' },
                                h('div', { className: 'w-10 h-10 bg-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0' },
                                    h('span', { className: 'text-white font-bold' }, currentQuestion + 1)
                                ),
                                h('div', null,
                                    h('h3', { className: 'font-semibold text-gray-900 mb-2' }, 'Scenario'),
                                    h('p', { className: 'text-gray-700 leading-relaxed' }, currentQ.scenario)
                                )
                            )
                        ),
                        h('div', { className: 'p-6' },
                            h('h4', { className: 'font-bold text-lg text-gray-900 mb-4' }, currentQ.question),
                            h('div', { className: 'space-y-3 mb-6' },
                                currentQ.options.map((option, idx) => {
                                    const isSelected = selectedAnswerIndex === idx;
                                    const buttonClass = isSelected 
                                        ? 'w-full text-left p-4 border-2 rounded-lg transition-all border-blue-600 bg-blue-50' 
                                        : 'w-full text-left p-4 border-2 rounded-lg transition-all border-gray-200 hover:border-blue-500 hover:bg-blue-50';
                                    
                                    const radioClass = isSelected
                                        ? 'w-6 h-6 border-2 rounded-full flex items-center justify-center flex-shrink-0 transition-all border-blue-600 bg-blue-600'
                                        : 'w-6 h-6 border-2 rounded-full flex items-center justify-center flex-shrink-0 transition-all border-gray-400 bg-white';
                                    
                                    const textClass = isSelected 
                                        ? 'leading-relaxed text-gray-900 font-medium' 
                                        : 'leading-relaxed text-gray-700';
                                    
                                    return h('button', {
                                        key: idx,
                                        onClick: () => handleAnswer(idx),
                                        className: buttonClass
                                    },
                                        h('div', { className: 'flex items-start gap-3' },
                                            h('div', { className: radioClass },
                                                isSelected ? h('div', { className: 'w-2.5 h-2.5 bg-white rounded-full' }) : null
                                            ),
                                            h('p', { className: textClass }, option.text)
                                        )
                                    );
                                })
                            ),
                            h('button', {
                                onClick: handleNextChallenge,
                                disabled: selectedAnswerIndex === null,
                                className: selectedAnswerIndex !== null
                                    ? 'w-full py-4 px-6 rounded-lg font-bold text-lg transition-all bg-blue-600 text-white hover:bg-blue-700 shadow-lg hover:shadow-xl cursor-pointer'
                                    : 'w-full py-4 px-6 rounded-lg font-bold text-lg transition-all bg-gray-200 text-gray-400 cursor-not-allowed'
                            }, currentQuestion === simulation.questions.length - 1 ? 'Complete Assessment â†’' : 'Next Challenge â†’')
                        )
                    ),
                    h('div', { className: 'text-center mt-6 text-sm text-gray-500' }, 'ðŸ’¡ Choose carefully - you only get one attempt at this module')
                )
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(PMSimulation));

        // SNIPPET 5: Retry failed events on page load
        window.addEventListener('load', () => {
            setTimeout(async () => {
                const failed = JSON.parse(localStorage.getItem('pmSimFailedEvents') || '[]');
                if (failed.length > 0) {
                    console.log(`ðŸ”„ Found ${failed.length} failed events, retrying...`);
                    
                    let successCount = 0;
                    const stillFailed = [];
                    
                    for (const event of failed) {
                        try {
                            await fetch(GOOGLE_SCRIPT_URL, {
                                method: 'POST',
                                mode: 'no-cors',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(event)
                            });
                            successCount++;
                            console.log('âœ… Successfully retried event:', event.event);
                        } catch (error) {
                            console.error('âŒ Failed to retry event:', error);
                            stillFailed.push(event);
                        }
                    }
                    
                    // Update localStorage with only the events that still failed
                    if (stillFailed.length > 0) {
                        localStorage.setItem('pmSimFailedEvents', JSON.stringify(stillFailed));
                        console.log(`âš ï¸ ${stillFailed.length} events still pending retry`);
                    } else {
                        localStorage.removeItem('pmSimFailedEvents');
                        console.log(`ðŸŽ‰ All ${successCount} events successfully retried!`);
                    }
                }
            }, 2000);
        });
    </script>
</body>
</
